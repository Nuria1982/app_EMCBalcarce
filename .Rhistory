agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
datos_filtrados$Fr_agua_util[1] <- fraccion_inicial
datos_filtrados$agua_util[1] <- fraccion_inicial * agua_util_total_val
for (i in 2:nrow(datos_filtrados)) {
datos_filtrados$ETR[i] <- if_else(
is.na(datos_filtrados$Fr_agua_util[i - 1]) | is.na(datos_filtrados$ETM[i]),
NA_real_,
if_else(
datos_filtrados$Fr_agua_util[i - 1] >= agua_util_total_val,
datos_filtrados$ETM[i],
disminucion_et_val * datos_filtrados$Fr_agua_util[i - 1] * datos_filtrados$ETM[i]
)
)
datos_filtrados$agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i - 1]) | is.na(datos_filtrados$Precipitacion_Pluviometrica[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
if_else(
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i] > agua_util_total_val,
agua_util_total_val,
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i]
)
)
datos_filtrados$Fr_agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i]) | is.na(agua_util_total_val),
NA_real_,
datos_filtrados$agua_util[i] / agua_util_total_val
)
datos_filtrados$deficiencia[i] <- if_else(
is.na(datos_filtrados$ETM[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
datos_filtrados$ETM[i] - datos_filtrados$ETR[i]
)
}
View(datos_filtrados)
datos
datos <- balcarce_EMC
datos <- subset(datos, select = -c(Direccion_Viento_200cm, Direccion_Viento_1000cm))
datos$Fecha <- as.Date(datos$Fecha, format = "%Y-%m-%d")
datos <- datos[order(datos$Fecha, decreasing = TRUE), ]
datos
datos_historicos <- datos %>%
filter(Año >= 1991 & Año <= 2020)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 01-10-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media),
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
datos_filtrados$Fr_agua_util[1] <- fraccion_inicial
datos_filtrados$agua_util[1] <- fraccion_inicial * agua_util_total_val
for (i in 2:nrow(datos_filtrados)) {
datos_filtrados$ETR[i] <- if_else(
is.na(datos_filtrados$Fr_agua_util[i - 1]) | is.na(datos_filtrados$ETM[i]),
NA_real_,
if_else(
datos_filtrados$Fr_agua_util[i - 1] >= agua_util_total_val,
datos_filtrados$ETM[i],
disminucion_et_val * datos_filtrados$Fr_agua_util[i - 1] * datos_filtrados$ETM[i]
)
)
datos_filtrados$agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i - 1]) | is.na(datos_filtrados$Precipitacion_Pluviometrica[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
if_else(
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i] > agua_util_total_val,
agua_util_total_val,
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i]
)
)
datos_filtrados$Fr_agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i]) | is.na(agua_util_total_val),
NA_real_,
datos_filtrados$agua_util[i] / agua_util_total_val
)
datos_filtrados$deficiencia[i] <- if_else(
is.na(datos_filtrados$ETM[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
datos_filtrados$ETM[i] - datos_filtrados$ETR[i]
)
}
View(datos_filtrados)
datos <- balcarce_EMC
datos <- subset(datos, select = -c(Direccion_Viento_200cm, Direccion_Viento_1000cm))
datos$Fecha <- as.Date(datos$Fecha, format = "%Y-%m-%d")
datos <- datos[order(datos$Fecha, decreasing = TRUE), ]
datos
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 01-10-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media),
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
datos_filtrados$Fr_agua_util[1] <- fraccion_inicial
datos_filtrados$agua_util[1] <- fraccion_inicial * agua_util_total_val
for (i in 2:nrow(datos_filtrados)) {
datos_filtrados$ETR[i] <- if_else(
is.na(datos_filtrados$Fr_agua_util[i - 1]) | is.na(datos_filtrados$ETM[i]),
NA_real_,
if_else(
datos_filtrados$Fr_agua_util[i - 1] >= agua_util_total_val,
datos_filtrados$ETM[i],
disminucion_et_val * datos_filtrados$Fr_agua_util[i - 1] * datos_filtrados$ETM[i]
)
)
datos_filtrados$agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i - 1]) | is.na(datos_filtrados$Precipitacion_Pluviometrica[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
if_else(
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i] > agua_util_total_val,
agua_util_total_val,
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i]
)
)
datos_filtrados$Fr_agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i]) | is.na(agua_util_total_val),
NA_real_,
datos_filtrados$agua_util[i] / agua_util_total_val
)
datos_filtrados$deficiencia[i] <- if_else(
is.na(datos_filtrados$ETM[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
datos_filtrados$ETM[i] - datos_filtrados$ETR[i]
)
}
View(datos_filtrados)
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes")
datos_filtrados
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media),
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 01-10-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media),
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
datos_filtrados
fecha_siembra <- 01-10-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media)
,
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 01-10-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media))
datos_filtrados
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_filtrados
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes")
datos_filtrados
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha)
datos_filtrados
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 10-01-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha)
datos_filtrados
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra = 10-01-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha)
datos_filtrados
datos <- balcarce_EMC
datos <- subset(datos, select = -c(Direccion_Viento_200cm, Direccion_Viento_1000cm))
datos$Fecha <- as.Date(datos$Fecha, format = "%Y-%m-%d")
datos <- datos[order(datos$Fecha, decreasing = TRUE), ]
datos
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra = 10-01-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
datos_filtrados
tail(datos_filtrados)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- 10-01-2023
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
tail(datos_filtrados)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- as.Date("2023-01-10")
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
tail(datos_filtrados)
# fecha_siembra <- as.Date(input$fecha_siembra)
fecha_siembra <- as.Date("2023-10-10")
datos_filtrados <- datos %>%
filter(Fecha >= fecha_siembra) %>%
select(Fecha, Temperatura_Abrigo_150cm, Precipitacion_Pluviometrica, Evapotranspiracion_Potencial)
tail(datos_filtrados)
datos_filtrados <- datos_filtrados %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos <- datos_historicos %>%
mutate(Dia_Mes = format(Fecha, "%m-%d"))
datos_historicos_avg <- datos_historicos %>%
group_by(Dia_Mes) %>%
summarise(
Temperatura_media = mean(Temperatura_Abrigo_150cm, na.rm = TRUE),
Evapotranspiracion_media = mean(Evapotranspiracion_Potencial, na.rm = TRUE),
.groups = "drop"
)
fraccion_inicial = 0.50
agua_util_total_val = 0.50
disminucion_et_val = 0.50
datos_filtrados <- datos_filtrados %>%
left_join(datos_historicos_avg, by = "Dia_Mes") %>%
arrange(Fecha) %>%
mutate(
Temperatura_Abrigo_150cm = coalesce(Temperatura_Abrigo_150cm, Temperatura_media),
Evapotranspiracion_Potencial = coalesce(Evapotranspiracion_Potencial, Evapotranspiracion_media),
TTB = if_else(Temperatura_Abrigo_150cm - 8 < 0, 0, Temperatura_Abrigo_150cm - 8),
GD_acum = cumsum(TTB),
Ttrelativo = GD_acum / 1790,
Kc = if_else(Ttrelativo > 0.16,
2.988041 * Ttrelativo^4 - 4.052411 * Ttrelativo^3 - 3.999317 * Ttrelativo^2 + 6.015032 * Ttrelativo - 0.390632,
0.4),
ETM = Kc * Evapotranspiracion_Potencial,
Fr_agua_util = NA_real_,
agua_util = NA_real_,
ETR = NA_real_,
deficiencia = NA_real_
)
datos_filtrados$Fr_agua_util[1] <- fraccion_inicial
datos_filtrados$agua_util[1] <- fraccion_inicial * agua_util_total_val
for (i in 2:nrow(datos_filtrados)) {
datos_filtrados$ETR[i] <- if_else(
is.na(datos_filtrados$Fr_agua_util[i - 1]) | is.na(datos_filtrados$ETM[i]),
NA_real_,
if_else(
datos_filtrados$Fr_agua_util[i - 1] >= agua_util_total_val,
datos_filtrados$ETM[i],
disminucion_et_val * datos_filtrados$Fr_agua_util[i - 1] * datos_filtrados$ETM[i]
)
)
datos_filtrados$agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i - 1]) | is.na(datos_filtrados$Precipitacion_Pluviometrica[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
if_else(
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i] > agua_util_total_val,
agua_util_total_val,
datos_filtrados$agua_util[i - 1] + datos_filtrados$Precipitacion_Pluviometrica[i] - datos_filtrados$ETR[i]
)
)
datos_filtrados$Fr_agua_util[i] <- if_else(
is.na(datos_filtrados$agua_util[i]) | is.na(agua_util_total_val),
NA_real_,
datos_filtrados$agua_util[i] / agua_util_total_val
)
datos_filtrados$deficiencia[i] <- if_else(
is.na(datos_filtrados$ETM[i]) | is.na(datos_filtrados$ETR[i]),
NA_real_,
datos_filtrados$ETM[i] - datos_filtrados$ETR[i]
)
}
View(datos_filtrados)
ggplot(datos_filtrados, aes(x = Fecha)) +
geom_line(aes(y = ETM, color = "ETM")) +
geom_line(aes(y = ETR, color = "ETR")) +
geom_line(aes(y = Fr_agua_util, color = "Fr_agua_util")) +
labs(title = "Consumo de Agua", x = "", y = "") +
theme_minimal() +
scale_color_manual(values = c("ETM" = "blue", "ETR" = "red", "Fr_agua_util" = "yellow"))
ggplot(datos_filtrados, aes(x = Fecha)) +
geom_line(aes(y = Precipitacion_Pluviometrica, color = "Precipitacion_Pluviometrica")) +
geom_line(aes(y = deficiencia, color = "deficiencia")) +
labs(title = "Déficit de Agua", x = "", y = "") +
theme_minimal() +
scale_color_manual(values = c("Precipitacion_Pluviometrica" = "blue", "deficiencia" = "red"))
runApp()
datos
runApp()
runApp()
runApp()
runApp()
runApp()
print(colnames(datos_balance))
